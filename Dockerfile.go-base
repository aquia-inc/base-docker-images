FROM cgr.dev/chainguard/go:latest@sha256:0d8add1d14d1c9e576ec660dcaa397fe0df8fb9a2159a52a7f489c66650cd087

# Trigger workflow with version extraction fix
USER nonroot
WORKDIR /workspace

# Extract Go version information and save to /tmp/versions.txt
SHELL ["/bin/sh", "-o", "pipefail", "-c"]
RUN go version > /tmp/go_version.txt && \
    GO_VERSION=$(go version | cut -d' ' -f3 | sed 's/go//') && \
    echo "go=${GO_VERSION}" > /tmp/versions.txt && \
    GO_MAJOR=$(echo "${GO_VERSION}" | cut -d'.' -f1) && \
    GO_MINOR="${GO_MAJOR}.$(echo "${GO_VERSION}" | cut -d'.' -f2)" && \
    echo "go_major_tag=${GO_MAJOR}" >> /tmp/versions.txt && \
    echo "go_minor_tag=${GO_MINOR}" >> /tmp/versions.txt && \
    head /tmp/versions.txt
