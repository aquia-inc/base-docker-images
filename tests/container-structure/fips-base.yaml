schemaVersion: 2.0.0

# Test FIPS base image functionality
commandTests:
  - name: "OpenSSL FIPS mode check"
    command: "openssl"
    args: ["version"]
    expectedOutput: ["OpenSSL"]
    
  - name: "FIPS mode enabled check"
    command: "openssl"
    args: ["list", "-providers"]
    expectedOutput: ["fips"]
    
  - name: "User is nonroot"
    command: "whoami"
    expectedOutput: ["nonroot"]

fileExistenceTests:
  - name: "OpenSSL binary exists"
    path: "/usr/bin/openssl"
    shouldExist: true
    
  - name: "FIPS config exists"
    path: "/etc/ssl/fipsmodule.cnf"
    shouldExist: true

metadataTest:
  user: "nonroot"